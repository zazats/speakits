<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv=”Permissions-Policy” content=”interest-cohort=()”>
    <title>S P E A K I T S</title>
    <script src="speakits_viewer_files/three.min.js"></script>
    <script src="speakits_viewer_files/panolens.min.js"></script>
    <link rel="stylesheet" href="viewer.css">	
</head>

<body>
    <div id="btn" class="center">
        <img src="assets/vr.png" class="image">
        <div class ="text">
		<h2>Start your  S P E A K I T X  experience</h2>
		<p>Turn your phone to the horizontal position, <br> 
        click the Start button and inset it in the VR Set.</p>
	</div>
        <button class="button" onclick="loadVenue()">Start</button>
    </div>

    <div id="container"></div>
    
    <div style="width:100%;margin-top:5%; text-align:center; display:none" id="cheat_not_container">
      <p id="cheat_note" style="word-break: break-all; white-space: normal; display:inline-block; width:20%; margin:5% auto; border-radius:255px 15px 225px 15px/15px 225px 15px 255px; padding:1em; line-height:1.5em; background:hsla(67, 95%, 95%, 1); border:solid 2px hsla(0, 95%, 35%, 1)">
	    Be cool. Everything is allright.
      </p>
    </div>	
	
<script>
    //DeviceOrientationEvent.requestPermission();
    
    var panorama, viewer, container;

    function getCheatNote(){
    	urlParams = new URL(window.location.toLocaleString()).searchParams;
	
	cheatNote = urlParams.get('cheat_note');   
	if (typeof cheatNote === 'string' && cheatNote !== '') {
	    document.getElementById('cheat_note').innerHTML = cheatNote;   
	}
    }
	
    function loadVenue(){
    
    document.getElementById("btn").style.display = "none";
    
    container = document.querySelector('#container');
    const urlParams = new URL(window.location.toLocaleString()).searchParams;
    imageFile = urlParams.get('image');
    if (imageFile == "imagine"){
       var rnd = Math.floor(Math.random() * 5) + 1;
	imageFile = "imagine" + rnd + ".jpeg";
    }
    
	//play audio    
	var audio = new Audio('assets/imagine_l1.mp3');
	audio.loop=true;    
    audio.play();   
    	
	infospot = new PANOLENS.Infospot(200, 'assets/notes4.png', true);
	infospot.position.set( 0, -1000, -1000);
    	//infospot.addHoverText( 'This is your cheat sheet. /n You will be able to upload your own notes via setup. /n Switch between notes by pointing at arrows.' );    
    getCheatNote();
	infospot.addHoverElement( document.getElementById( 'cheat_not_container' ), 100 );

        //infospot2 = new PANOLENS.Infospot( 300, PANOLENS.DataImage.Info );
        //infospot2.position.set( -200, -1000, -1000 );
        //infospot2.addHoverElement( document.getElementById( 'desc-container' ), 200 );
	    
	panorama = new PANOLENS.ImagePanorama( 'assets/' + imageFile, 50 );
	panorama.add( infospot );
        //panorama.add( infospot2 );
    
    //panorama = new PANOLENS.ImagePanorama( 'assets/v1_l1.jpg' );
    //panorama = new PANOLENS.VideoPanorama( 'assets/360video3.mp4' )
    viewer = new PANOLENS.Viewer({container : container});
    //viewer = new PANOLENS.Viewer();
    viewer.add( panorama );
    
    var ef = 0, ctrl = 0;
    if (/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(navigator.userAgent)) {
        ef = 2;
	ctrl = 1;
    }
    viewer.enableControl( ctrl );
    viewer.enableEffect( ef );
    //viewer.setCameraControl();
    viewer.setCameraFov(90);
    //viewer.camera.setFoclaLength(34);	    
    //viewer.camera.position.y = -200;
    //viewer.camera.position.set(0, 0, 0);

    //container.requestFullscreen(); //doesn't work for Safari. Also, dosn't look great in the VR Set
    }
</script>
</body>
</html>
